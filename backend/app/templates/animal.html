<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PetPal — Animal</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    a { color: inherit; }
    .wrap { max-width: 900px; margin: 0 auto; }
    .back { display:inline-block; margin-bottom: 16px; color:#444; text-decoration:none; }
    .card { border: 1px solid #ddd; border-radius: 14px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.06); }
    .imgwrap { width: 100%; height: 360px; background: #f3f3f3; display:flex; align-items:center; justify-content:center; }
    .imgwrap img { width: 100%; height: 100%; object-fit: cover; }
    .content { padding: 16px 18px; }
    .name { font-size: 26px; font-weight: 800; margin: 0 0 10px; }
    .meta { margin: 6px 0; color:#333; }
    .tag { display: inline-block; font-size: 12px; padding: 4px 10px; border-radius: 999px; background: #eee; margin-top: 10px; }
    .desc { margin-top: 14px; color:#444; line-height: 1.45; }
    .error { color: #b00020; }
    .actions { margin-top: 16px; display:flex; gap: 10px; }
    .btn { padding: 10px 12px; border-radius: 10px; border: 1px solid #ddd; background: #fff; cursor: pointer; }
  </style>
</head>
<body>
  <div class="wrap">
    <a class="back" href="/adopt">← Back to adoptable animals</a>

    <div id="status"></div>

    <div class="card" id="card" style="display:none;">
      <div class="imgwrap" id="imgwrap"></div>
      <div class="content">
        <p class="name" id="name"></p>
        <p class="meta" id="species"></p>
        <p class="meta" id="age"></p>
        <span class="tag" id="statusTag"></span>

        <div class="desc" id="description"></div>

        <div class="actions">
          <button class="btn" onclick="alert('Next step: adoption application form')">
            Apply to Adopt (coming next)
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Flask passes this in from the route
    const animalId = {{ animal_id }};

    async function loadAnimal() {
      const statusEl = document.getElementById("status");
      const card = document.getElementById("card");

      statusEl.textContent = "Loading...";
      statusEl.className = "";

      try {
        const res = await fetch(`/animals/${animalId}`);
        if (!res.ok) throw new Error("Request failed: " + res.status);

        const a = await res.json();

        document.getElementById("name").textContent = a.name ?? "Unnamed";
        document.getElementById("species").innerHTML = `<strong>Species:</strong> ${a.species ?? "-"}`;
        document.getElementById("age").innerHTML = `<strong>Age:</strong> ${a.age ?? "-"}`;
        document.getElementById("statusTag").textContent = a.status ?? "available";
        document.getElementById("description").textContent = a.description || "No description yet.";

        const imgwrap = document.getElementById("imgwrap");
        if (a.image_url) {
          imgwrap.innerHTML = `<img src="${a.image_url}" alt="${a.name ?? "Animal"}" />`;
        } else {
          imgwrap.innerHTML = `<div style="color:#777;">No Image</div>`;
        }

        statusEl.textContent = "";
        card.style.display = "block";
      } catch (err) {
        statusEl.textContent = "Error loading animal: " + err.message;
        statusEl.className = "error";
      }
    }

    loadAnimal();
  </script>
</body>
</html>
